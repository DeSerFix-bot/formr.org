!function(a){"use strict";function b(b,c){a(c).click(function(b){b.preventDefault();var c=a(this),d=c.attr("href");return""===d?!1:(c.attr("href",""),a.ajax({type:"GET",url:d,dataType:"html"}).done(a.proxy(function(b){var c=a(this);c.attr("href",d),c.hasClass("danger")||c.css("color","green");var e=c.find("i.fa");e.hasClass("fa-stethoscope")?(e.addClass("fa-heartbeat"),e.removeClass("fa-stethoscope")):e.hasClass("fa-heartbeat")?(e.removeClass("fa-heartbeat"),e.addClass("fa-stethoscope")):bootstrap_modal("Alert",b,"tpl-feedback-modal"),c.hasClass("refresh_on_success")&&document.location.reload(!0)},this)).fail(a.proxy(function(b,c,e,f){a(this).attr("href",d),ajaxErrorHandling(b,c,e,f)},this)),!1)})}function c(b,c){a(c).submit(function(b){b.preventDefault();var c=a(this),d=c.find("button[type=submit].btn");return d.attr("disabled",!0),a.ajax({type:c.attr("method"),url:c.attr("action"),data:c.serialize(),dataType:"html"}).done(a.proxy(function(b){d.attr("disabled",!1),d.css("color","green"),a(".main_body").prepend(b),d.hasClass("refresh_on_success")&&document.location.reload(!0)},this)).fail(a.proxy(function(a,b,c,e){d.attr("disabled",!1),ajaxErrorHandling(a,b,c,e)},this)),!1})}function d(b){var c=parseInt(a(this).data("user"),10),d=a(this).data("email");if(c&&d){var f={user_id:c,user_email:d,user_api:!0,api_action:"get"};g(saAjaxUrl,f,function(a){a&&a.success&&e(a.data,f)})}}function e(b,c){var d=a(a.parseHTML(getHTMLTemplate("tpl-user-api",{user:" ("+b.user+")",client_id:b.client_id,client_secret:b.client_secret})));b.client_id?d.find(".api-create").remove():d.find(".api-change, .api-delete").remove(),d.on("shown.bs.modal",function(){d.find(".api-create").click(function(){if(confirm("Are you sure?")){var a={user_id:c.user_id,user_email:c.user_email,user_api:!0,api_action:"create"};g(saAjaxUrl,a,function(a){a&&a.success&&(d.modal("hide"),e(a.data,c))})}}),d.find(".api-change").click(function(){if(confirm("Are you sure?")){var a={user_id:c.user_id,user_email:c.user_email,user_api:!0,api_action:"change"};g(saAjaxUrl,a,function(a){a&&a.success&&(d.modal("hide"),e(a.data,c))})}}),d.find(".api-delete").click(function(){if(confirm("Are you sure?")){var a={user_id:c.user_id,user_email:c.user_email,user_api:!0,api_action:"delete"};g(saAjaxUrl,a,function(a){a&&a.success&&(d.modal("hide"),e({user:b.user,client_id:"",client_secret:""},c))})}})}).on("hidden.bs.modal",function(){d.remove()}).modal("show")}function f(b){var c=a(this),d=a(a.parseHTML(getHTMLTemplate("tpl-delete-run-session",{action:c.data("href"),session:c.data("session")})));d.on("hidden.bs.modal",function(){d.remove()}).modal("show")}function g(b,c,d,e){e=e||"json",a.ajax({type:"POST",url:b,data:c,dataType:e,success:function(a,b,c){d(a)},error:function(b,c){a(".main_body").prepend(c)},beforeSend:function(a){}})}function h(){var b=a(this);"single"===b.data("active")?(b.siblings(".single").addClass("hidden"),b.siblings(".multiple").removeClass("hidden"),b.data("active","multiple")):(b.siblings(".single").removeClass("hidden"),b.siblings(".multiple").addClass("hidden"),b.data("active","single"))}a(function(){var e;a(".form-ajax").each(c),a(".link-ajax").each(b),a(".link-ajax .fa-pause").parent(".btn").mouseenter(function(){a(this).find(".fa").removeClass("fa-pause").addClass("fa-play")}).mouseleave(function(){a(this).find(".fa").addClass("fa-pause").removeClass("fa-play")}),a(".link-ajax .fa-stop").parent(".btn").mouseenter(function(){a(this).find(".fa").removeClass("fa-stop").addClass("fa-play")}).mouseleave(function(){a(this).find(".fa").addClass("fa-stop").removeClass("fa-play")}),a(".api-btn").click(d),a(".sessions-search-switch").click(h),a(".hidden_debug_message").length>0&&(a(".show_hidden_debugging_messages").click(function(){return a(".hidden_debug_message").toggleClass("hidden"),!1}),a(".show_hidden_debugging_messages").attr("disabled",!1)),a("abbr.abbreviated_session").click(function(){a(this).text()!==a(this).data("full-session")?a(this).text(a(this).data("full-session")):a(this).text(a(this).data("full-session").substr(0,10)+"â€¦")}),a(".download_r_code").length>0&&a(".download_r_code").click(function(){return download_next_textarea(this)}),a(".removal_modal").on("show.bs.modal",function(c){e=a(c.relatedTarget);var d=a(this);e.parents("tr").css("background-color","#ee5f5b"),a(this).find(".danger").attr("href",e.data("href")),b(1,a(this).find(".danger")),a(this).find(".danger").click(function(a){e.css("color","#ee5f5b"),d.hasClass("refresh_on_success")&&window.setTimeout(function(){document.location.reload(!0)},200),d.modal("hide")})}).on("hide.bs.modal",function(a){e.parents("tr").css("background-color","transparent")}),a("a.delete-run-session").bind("click",f)})}(jQuery);